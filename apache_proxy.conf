<VirtualHost *:80>
    ServerAdmin webmaster@localhost
    DocumentRoot /var/www/html

    <Directory /var/www/html>
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>

    RewriteEngine on
    RewriteCond %{HTTP:Upgrade} websocket [NC]
    RewriteCond %{HTTP:Connection} upgrade [NC]
    RewriteRule ^/console/(.*) "unix:/opt/sockets/ttyd.sock|ws://localhost/$1" [P,L]

    ProxyPass /console unix:/opt/sockets/ttyd.sock|http://localhost/
    ProxyPassReverse /console unix:/opt/sockets/ttyd.sock|http://localhost/
</VirtualHost>
